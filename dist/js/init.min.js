// memba.blog 0.1.0 built on 10-02-2014 - Copyright (c) 2013-2014 Memba. All rights reserved.
var CONFIG="./config.json";!function(){"use strict";var a=Function,b=a("return this")(),c=b.Modernizr,d="2013.3.1324",e=!0,f="app.init.js: ",g=new XMLHttpRequest;g.onload=function(){if("string"==typeof this.responseText){var a=b.app=b.app||{},g=a.config=JSON.parse(this.responseText);if(/bot|crawl|spider|preview/i.test(navigator.userAgent)){var h="\n",i=":",j="",k=function(a){var b=a.trim().replace(/\r\n/gm,h).replace(/\r/gm,h),c={},d=b.indexOf(h+h);if(d>0){var e=!1,f=b.substr(0,d).trim(),g=f.split(h).length,j=/^(?:\s*)(\w+)(?:\s*)\:(?:\s*)([^\r\n]+)(?:\s*)$/gm,k=[];j.test(f)&&(k=f.match(j),e=k.length===g),e&&k.forEach(function(a){try{var b=a.indexOf(i);c[a.substr(0,b).trim()]=a.substr(b+1).trim()}catch(d){}})}return c},l=function(a){var b=a.trim().replace(/\r\n/gm,h).replace(/\r/gm,h),c=b.indexOf(h+h);return c>0?b.substr(c+2).trim():b},m=new XMLHttpRequest;m.onload=function(){var a=/<loc>([^\<\>]*)<\/loc>/gi;"string"==typeof this.responseText&&(j+='<section role="navigation"><ul>'+this.responseText.match(a).join("").replace(a,'<li><a href="$1">$1</a></li>')+"</ul></section>");var b;if(window.location.search.length>1){var c=function(){var a,b=window.location.search.substr(1),c=b.split(/\&/),d=c.length,e={};if(0===d)return!1;for(;d--;)a=c[d].split(/\=/),e[a[0]]=decodeURIComponent(a[1]||"")||!0;return e}();c&&c.r&&(b=c.r.replace(/^\/[^\/\(\:]*\//,g.paths.root+g.paths.posts)+".md")}else"string"==typeof g.paths.root&&"string"==typeof g.paths.pages&&"string"==typeof g.paths.home&&(b=g.paths.root+g.paths.pages+g.paths.home);var d=new XMLHttpRequest;d.onload=function(){var a=document.getElementById("raw"),b=k(this.responseText),c=l(this.responseText);a&&(j+='<section role="article">',b.title&&(j+="<h1>"+b.title+"</h1>"),j+="<article>",j+=c.replace(/^[\s]*#[\s]*([^\#\r\n]+)[\#\r\n]*/gm,"\n<h1>$1</h1>\n").replace(/^[\s]*##[\s]*([^\#\r\n]+)[\#\r\n]*/gm,"\n<h2>$1</h2>\n").replace(/^[\s]*###[\s]*([^\#\r\n]+)[\#\r\n]*/gm,"\n<h3>$1</h3>\n"),j+="</article></section>",a.innerHTML=j)},d.open("get",b,!0),d.send()},m.open("get",g.paths.root+g.paths.sitemap,!0),m.send()}else{if(e&&b.console&&(b.console.log(f+b.navigator.userAgent),b.console.log(f+b.location.href)),b.location.search.length>1){var n=function(){var a,b=window.location.search.substr(1),c=b.split(/\&/),d=c.length,e={};if(0===d)return!1;for(;d--;)a=c[d].split(/\=/),e[a[0]]=decodeURIComponent(a[1]||"")||!0;return e}();n&&n.r&&b.location.assign(b.location.protocol+"//"+b.location.host+b.location.pathname+"#"+n.r)}c.load([{load:"//code.jquery.com/jquery-1.10.2.min.js",callback:function(a){e&&b.console&&b.console.log(f+a+" loading attempt")},complete:function(){b.jQuery||c.load(g.paths.root+"js/"+d+"/jquery.min.js")}},{load:["//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css","//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css","//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"],callback:function(a){e&&b.console&&b.console.log(f+a+" loading attempt")},complete:function(){!$||$.fn.affix&&$.fn.carousel&&$.fn.popover&&$.fn.tab&&$.fn.tooltip||c.load([{load:[g.paths.root+"styles/vendor/font-awesome.css",g.paths.root+"styles/vendor/bootstrap.css",g.paths.root+"js/vendor/bootstrap.min.js"]}])}},{load:["//cdn.kendostatic.com/"+d+"/styles/kendo.common-bootstrap.min.css","//cdn.kendostatic.com/"+d+"/styles/kendo.bootstrap.min.css","//cdn.kendostatic.com/"+d+"/js/kendo.web.min.js","//cdn.kendostatic.com/"+d+"/js/cultures/kendo.culture.en.min.js","//cdn.kendostatic.com/"+d+"/js/cultures/kendo.culture."+(b.navigator.userLanguage||b.navigator.language).substr(0,2)+".min.js","//cdn.kendostatic.com/"+d+"/js/cultures/kendo.culture.fr.min.js"],callback:function(a){e&&b.console&&b.console.log(f+a+" loading attempt")},complete:function(){b.kendo||c.load([{load:[g.paths.root+"styles/"+d+"/kendo.common-bootstrap.min.css",g.paths.root+"styles/"+d+"/kendo.bootstrap.min.css",g.paths.root+"js/"+d+"/kendo.web.min.js",g.paths.root+"js/"+d+"/cultures/kendo.culture.en.min.js",g.paths.root+"js/"+d+"/cultures/kendo.culture."+(b.navigator.userLanguage||b.navigator.language).substring(0,2)+".min.js",g.paths.root+"js/"+d+"/cultures/kendo.culture.fr.min.js"]}])}},{load:["//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/styles/solarized_light.min.css","//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.0/highlight.min.js","//cdnjs.cloudflare.com/ajax/libs/marked/0.3.0/marked.min.js",g.paths.root+"styles/vendor/memba.widgets.min.css",g.paths.root+"js/vendor/memba.widgets.min.js"],callback:function(a){e&&b.console&&b.console.log(f+a+" loading attempt")},complete:function(){b.hljs||c.load([{load:[g.paths.root+"styles/vendor/highlight/solarized_light.min.css",g.paths.root+"js/vendor/highlight.min.js"]}]),b.marked||c.load(g.paths.root+"js/vendor/marked.min.js")}},{test:e,yep:[g.paths.root+"styles/app.styles.css",g.paths.root+"js/app.constants.js",g.paths.root+"js/app.localizer.js",g.paths.root+"js/app.viewmodels.js",g.paths.root+"js/app.controller.js"],nope:[g.paths.root+"styles/memba.blog.min.css",g.paths.root+"js/memba.blog.min.js"],callback:function(a){e&&b.console&&b.console.log(f+a+" loading attempt")},complete:function(){$(document).ready(function(){$.when($.ajax(g.paths.root+g.paths.header),$.ajax(g.paths.root+g.paths.footer)).then(function(b,c){$(a.tags.BODY).append(b[0]),$(a.tags.BODY).append(c[0]),$(document).trigger(a.events.INITIALIZE)},function(c,d,h){e&&b.console&&$.type(b.console.error)===a.types.FUNCTION&&b.console.error(f+g.paths.header+" or "+g.paths.footer+" "+h)})})}}])}}},g.open("get",CONFIG,!0),g.send()}();